<html>
<head>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<!-- 	<script type="text/javascript">
		$(document).ready(function() {
			$("#test").click(function(){
				alert();
				$.getJSON("https://prometheus-asgard.myshopify.com/cart.json", function(result) {
					console.log(json);
				});
});
				
// 				$.ajax({
// 					url: "https://prometheus-asgard.myshopify.com/cart.json",
// 					dataType: "jsonp",
// 					success: jsonCallback(json)
// 				});
			});

// 		$(document).ready(function(){
//     $("button").click(function(){
//         $.getJSON("demo_ajax_json.js", function(result){
//             $.each(result, function(i, field){
//                 $("div").append(field + " ");
//             });
//         });
//     });
// });
		
</script> -->
	
</head> 

<body>

 	<h2>Sync Configuration With Cheyenne</h2> 
	
	<button onclick="sync()">Sync With Cheyenne!</button>
	<br>
	<br>
	<button id="test" onclick="createCORSRequest('GET', 'https://prometheus-asgard.myshopify.com/cart.json')">Cart Details</button>
	<br>
	<br>
	
	<div id="demo">
	</div>
	
 	<script type='text/javascript'>
		
		function sync() {
			var xhttp = new XMLHttpRequest();
			xhttp.onreadystatechange = function() {
				if (this.readyState == 4 && this.status == 200) {
					document.getElementById("demo").innerHTML = this.responseText;
				}
			};
			
			xhttp.open("GET", "https://10.8.93.189:8443/v1/ede/channel/recommendations", true);
			xhttp.send();
		}
		
		function jsonCallback(json) {
			alert();
			console.log(json);
		}
		
		function getCart() {
			
			
// 			var queryString = $("script[src*='sync.js']").attr('src').split('?')[1];
// 			console.log("sync page " + queryString);

// 	var variables = queryString.split("&");
// 	console.log(variables);
	
// 	var planVariables = variables[0];
// 	console.log(planVariables);
	
// 	var planType = planVariables.split("=");
// 	console.log(planType);
// 	var plan = planType[1];
// 	console.log(plan);
			
// 			var xhttp = new XMLHttpRequest();
// 			xhttp.onreadystatechange = function() {
// 				if (this.readyState == 4 && this.status == 200) {
// 					document.getElementById("demo").innerHTML = this.responseText;
// 				}
// 			};
			
// 			xhttp.open("GET", "https://prometheus-asgard.myshopify.com/cart.json", true);
// 			xhttp.send();
			
		}
		
		function createCORSRequest(method, url) {
			alert('inside createCORSRequest');
			var xhr = new XMLHttpRequest();
			if ("withCredentials" in xhr) {
				alert('inside with');
				// Check if the XMLHttpRequest object has a "withCredentials" property.
				// "withCredentials" only exists on XMLHTTPRequest2 objects.
				xhr.open(method, url, true);
				alert(xhr);
				console.log(xhr);
			} else if (typeof XDomainRequest != "undefined") {
				alert('inside undefined');
				// Otherwise, check if XDomainRequest.
				// XDomainRequest only exists in IE, and is IE's way of making CORS requests.
				xhr = new XDomainRequest();
				xhr.open(method, url);
		  	} else {
				alert('inside else');
				// Otherwise, CORS is not supported by the browser.
				xhr = null;
			}
			return xhr;
		}
		
		function getTitle(text) {
			return text.match('<title>(.*)?</title>')[1];
		}
		
		function makeCorsRequest() {
			alert('inside makeCorsRequest');
			// This is a sample server that supports CORS.
			var url = 'https://prometheus-asgard.myshopify.com/cart.json';
			
			var xhr = createCORSRequest('GET', url);
			if (!xhr) {
				alert('inside xhr is not');
				alert('CORS not supported');
				return;
			}
			
			// Response handlers.
			xhr.onload = function() {
				alert('inside onload');
				var text = xhr.responseText;
				var title = getTitle(text);
				alert('Response from CORS request to ' + url + ': ' + title);
			};
			
			xhr.onerror = function() {
				alert('inside on error');
				alert('Woops, there was an error making the request.');
			};
			
			xhr.send();
		}
		
// 		var xhr = createCORSRequest('GET', url);
// 		if (!xhr) {
// 			throw new Error('CORS not supported');
// 		}
		
	</script>
</body>
</html> 
